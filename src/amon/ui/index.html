<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Amonï½œChat UI</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.10.0/styles/github.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.10.0/lib/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <script type="module">
      import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
      mermaid.initialize({ startOnLoad: false, theme: "neutral" });
      window.__mermaid = mermaid;
    </script>
  </head>
  <body>
    <main class="page">
      <div class="ui-shell" id="ui-shell">
        <aside class="shell-sidebar" aria-label="ä¸»è¦å°è¦½" data-i18n-attr="aria-label:a11y.sidebar">
          <h2>Amon UI</h2>
          <nav class="shell-nav" id="shell-nav">
            <a class="shell-nav__item shell-nav__link" data-shell-view="chat" data-route="chat" href="#/chat" data-i18n="nav.chat">å°è©±</a>
            <a class="shell-nav__item shell-nav__link" data-shell-view="context" data-route="context" href="#/context" data-i18n="nav.context">æƒ…å¢ƒ</a>
            <a class="shell-nav__item shell-nav__link" data-shell-view="graph" data-route="graph" href="#/graph" data-i18n="nav.graph">æµç¨‹åœ–</a>
            <a class="shell-nav__item shell-nav__link" data-shell-view="tools-skills" data-route="tools" href="#/tools" data-i18n="nav.tools">å·¥å…·èˆ‡æŠ€èƒ½</a>
            <a class="shell-nav__item shell-nav__link" data-shell-view="config" data-route="config" href="#/config" data-i18n="nav.config">è¨­å®š</a>
            <a class="shell-nav__item shell-nav__link" data-shell-view="logs-events" data-route="logs" href="#/logs" data-i18n="nav.logs">æ—¥èªŒèˆ‡äº‹ä»¶</a>
            <a class="shell-nav__item shell-nav__link" data-shell-view="docs" data-route="docs" href="#/docs" data-i18n="nav.docs">æ–‡ä»¶</a>
            <a class="shell-nav__item shell-nav__link" data-shell-view="bill" data-route="billing" href="#/billing" data-i18n="nav.billing">è¨ˆè²»</a>
          </nav>
        </aside>

        <section class="shell-main">
          <header class="shell-topbar" aria-label="å·¥ä½œåˆ—" data-i18n-attr="aria-label:a11y.topbar">
            <div class="shell-topbar__group">
              <label class="field-label shell-topbar__field">
                <span data-i18n="topbar.project">å°ˆæ¡ˆ</span>
                <select id="project-select"></select>
              </label>
              <span class="shell-status shell-status--run pill--neutral" id="shell-run-status" title="å°šæœªæœ‰ Run" data-i18n="status.run.idle" data-i18n-attr="title:tooltip.runIdle">å°šæœªæœ‰ Run</span>
              <span class="shell-status shell-status--daemon pill--neutral" id="shell-daemon-status" title="å°šæœªé€£ç·š daemon" data-i18n="status.daemon.idle" data-i18n-attr="title:tooltip.daemonIdle">å°šæœªé€£ç·š</span>
              <span class="shell-status shell-status--budget" id="shell-budget-status">Budgetï¼šNT$ 0 / NT$ 5,000</span>
            </div>
            <div class="shell-topbar__actions">
              <button type="button" class="secondary-btn shell-sidebar-toggle" id="toggle-sidebar" aria-label="æ”¶åˆå´æ¬„" data-i18n-attr="aria-label:topbar.toggleSidebar">â˜°</button>
              <button type="button" class="secondary-btn shell-context-toggle" id="toggle-context-panel" aria-expanded="true" data-i18n="topbar.toggleContext">æ”¶åˆå³å´é¢æ¿</button>
            </div>
          </header>

          <div class="layout chat-layout" id="chat-layout">
            <section class="main-card chat-panel">
          <header class="chat-header">
            <div>
              <h1>Amon Chat</h1>
              <p class="subtitle">è«‹ç”¨è‡ªç„¶èªè¨€æ“ä½œå°ˆæ¡ˆèˆ‡ä»»å‹™ï¼ˆæ”¯æ´ streamingï¼‰ã€‚</p>
            </div>
            <div class="chat-controls">
              <span class="chat-project-label" id="chat-project-label">ç›®å‰å°ˆæ¡ˆï¼šæœªæŒ‡å®šå°ˆæ¡ˆ</span>
              <button class="secondary-btn" id="refresh-context">åˆ·æ–° Context</button>
            </div>
          </header>

          <section id="timeline" class="chat-timeline"></section>

          <div class="progress-bar" id="stream-progress" aria-hidden="true">
            <span></span>
          </div>

          <section id="plan-card" class="plan-card" hidden>
            <div class="plan-card__header">
              <h3>Plan Card</h3>
              <p>æ­¤æ“ä½œéœ€è¦ç¢ºèªæ‰èƒ½ç¹¼çºŒã€‚</p>
            </div>
            <div class="plan-grid">
              <div>
                <h4>Commands</h4>
                <ul id="plan-commands" class="plan-list"></ul>
              </div>
              <div>
                <h4>Graph Patches</h4>
                <ul id="plan-patches" class="plan-list"></ul>
              </div>
            </div>
            <div class="plan-risk" id="plan-risk"></div>
            <pre id="plan-content"></pre>
            <div class="plan-card__actions">
              <button class="secondary-btn" id="plan-cancel">å–æ¶ˆ</button>
              <button class="primary-btn" id="plan-confirm">ç¢ºèªåŸ·è¡Œ</button>
            </div>
          </section>

          <form id="chat-form" class="chat-input">
            <div class="chat-input__main">
              <textarea id="chat-input" rows="4" placeholder="è¼¸å…¥ä½ çš„éœ€æ±‚ï¼Œä¾‹å¦‚ï¼šå»ºç«‹å°ˆæ¡ˆ Amon Demo" data-i18n-attr="placeholder:placeholder.chatInput"></textarea>
              <div class="chat-input__toolbar">
                <label class="file-btn">
                  åŠ å…¥é™„ä»¶
                  <input id="chat-attachments" type="file" multiple accept="image/*,video/*,.pdf" />
                </label>
                <span class="chat-input__hint">æ”¯æ´åœ–ç‰‡ã€PDFã€å½±ç‰‡ï¼›é™„ä»¶æœƒä»¥æ–‡å­—æ‘˜è¦é€å‡ºã€‚</span>
              </div>
              <div id="attachment-preview" class="attachment-preview"></div>
            </div>
            <button type="submit" class="primary-btn">é€å‡º</button>
          </form>
        </section>
            <div class="context-resizer" id="context-resizer" role="separator" aria-label="èª¿æ•´å³å´é¢æ¿å¯¬åº¦" aria-orientation="vertical"></div>

            <aside class="context-panel" id="context-panel">
          <h2>Thinking / Artifacts</h2>
          <div class="context-shell" id="context-shell" hidden>
            <article class="context-shell-card">
              <p class="context-shell-card__label">Memory</p>
              <strong id="card-memory">å°šæœªåŒæ­¥</strong>
            </article>
            <article class="context-shell-card">
              <p class="context-shell-card__label">Run</p>
              <strong id="card-run-progress">å°šæœªé–‹å§‹</strong>
            </article>
            <article class="context-shell-card">
              <p class="context-shell-card__label">Billing</p>
              <strong id="card-billing">NT$ 0</strong>
            </article>
            <article class="context-shell-card">
              <p class="context-shell-card__label">Pending</p>
              <strong id="card-pending-confirmations">0</strong>
            </article>
          </div>
          <div class="context-project" id="context-project" hidden>ç›®å‰å°ˆæ¡ˆï¼šæœªé¸æ“‡</div>
          <p id="context-overview" class="context-overview" hidden>è«‹å…ˆåœ¨ä¸Šæ–¹é¸æ“‡å°ˆæ¡ˆï¼Œå³å´å…§å®¹æœƒè‡ªå‹•åŒæ­¥ã€‚</p>
          <section class="context-section" id="inspector-thinking">
            <h3>Thinking Inspector</h3>
            <section class="thinking-panel" id="thinking-panel">
              <div class="thinking-panel__header">
                <h3>Thinking ç‹€æ…‹</h3>
                <label class="field-label thinking-mode">
                  é¡¯ç¤ºæ¨¡å¼
                  <select id="thinking-mode">
                    <option value="off">off</option>
                    <option value="brief" selected>brief</option>
                    <option value="verbose">verbose</option>
                  </select>
                </label>
              </div>
              <details open id="thinking-details">
                <summary id="thinking-summary">ç›®å‰æ²’æœ‰ Thinking äº‹ä»¶</summary>
                <div id="thinking-detail" class="thinking-panel__detail"></div>
              </details>
              <p class="context-overview">èªªæ˜ï¼šåªæœ‰åœ¨ AI æ­£åœ¨ä¸²æµå›è¦†ã€ç”¢ç”Ÿè¨ˆç•«ï¼ˆPlanï¼‰æˆ–å›å‚³å·¥å…·çµæœæ™‚ï¼Œé€™è£¡æ‰æœƒå‡ºç¾å…§å®¹ï¼›å¾…æ©Ÿæ™‚æœƒé¡¯ç¤º idleã€‚</p>
            </section>
          </section>
          <section class="context-section" id="inspector-execution" hidden>
            <section class="execution-timeline" id="execution-timeline" aria-label="Execution Timeline">
              <header class="execution-timeline__header">
                <h3>Execution Timeline</h3>
                <p>é¡¯ç¤º Thinking / Planning / Tool / Node ç›®å‰é€²åº¦ï¼ˆéƒ¨åˆ†å¯èƒ½ç”±äº‹ä»¶æ¨æ¸¬ï¼‰ã€‚</p>
              </header>
              <div id="execution-accordion" class="execution-accordion"></div>
            </section>
          </section>
          <section class="context-section" id="inspector-artifacts">
            <h3>Artifacts Inspector</h3>
            <p class="context-overview" id="artifacts-overview">é€™è£¡åƒ…é¡¯ç¤ºæµç¨‹ç”¢ç”Ÿçš„æª”æ¡ˆï¼›å°è©±ç´€éŒ„è«‹ä½¿ç”¨ä¸‹æ–¹ã€Œä¸‹è¼‰å°è©±ç´€éŒ„ã€ã€‚</p>
            <div class="artifacts-empty__actions">
              <button type="button" class="secondary-btn small" id="artifacts-download-chat">ä¸‹è¼‰å°è©±ç´€éŒ„</button>
            </div>
            <div id="artifacts-inspector-list" class="artifacts-inspector-list"></div>
            <div id="artifacts-empty" class="artifacts-empty" hidden>
              <p>å°šç„¡ artifactsï¼ˆå¯èƒ½æ˜¯ run å°šæœªå®Œæˆæˆ–æ­¤æµç¨‹æœªç”¢å‡ºæª”æ¡ˆï¼‰ã€‚</p>
              <div class="artifacts-empty__actions">
                <button type="button" class="secondary-btn small" id="artifacts-go-run">å‰å¾€ Thinking</button>
              </div>
            </div>
          </section>
            </aside>
          </div>


          <section class="main-card bill-page bill-page--mobile" id="bill-page" hidden>
            <header class="bill-mobile-topbar">
              <div class="bill-mobile-topbar__left">
                <button type="button" class="bill-mobile-icon" aria-label="è¿”å›">â†</button>
                <h2>è²»ç”¨èˆ‡ç”¨é‡</h2>
              </div>
              <div class="bill-mobile-topbar__right">
                <span class="bill-plan-chip">PRO PLAN</span>
                <button type="button" class="bill-mobile-icon" id="bill-refresh" aria-label="é‡æ–°æ•´ç†">â‹®</button>
              </div>
            </header>

            <div class="bill-mobile-scroll">
              <section class="bill-summary-grid" aria-label="è²»ç”¨æ‘˜è¦">
                <article class="bill-summary-card">
                  <p>ç¸½èŠ±è²»</p>
                  <strong id="bill-project-total">--</strong>
                  <small>ç›®å‰è¨ˆè²»é€±æœŸ</small>
                </article>
                <article class="bill-summary-card">
                  <p>ä»Šæ—¥ç”¨é‡</p>
                  <strong id="bill-today">--</strong>
                  <small>æ—¥å‡ token ä¼°ç®—</small>
                </article>
              </section>

              <section class="bill-section">
                <div class="bill-section__header">
                  <h3>ç”¨é‡è¶¨å‹¢</h3>
                  <div class="bill-range-tabs"><span class="is-active">7D</span><span>30D</span><span>å…¨éƒ¨</span></div>
                </div>
                <article class="bill-chart-card">
                  <canvas id="bill-run-chart" height="150" aria-label="æ¯ run èŠ±è²»é•·æ¢åœ–"></canvas>
                </article>
              </section>

              <section class="bill-section">
                <div class="bill-section__header">
                  <h3>æˆæœ¬åˆ†ä½ˆ</h3>
                </div>
                <div class="bill-model-cards">
                  <article class="bill-model-card">
                    <header><h4>provider</h4><span>ä¾†æº</span></header>
                    <pre id="bill-breakdown-provider">å°šæœªè¼‰å…¥ã€‚</pre>
                  </article>
                  <article class="bill-model-card">
                    <header><h4>model</h4><span>æ¨¡å‹</span></header>
                    <pre id="bill-breakdown-model">å°šæœªè¼‰å…¥ã€‚</pre>
                  </article>
                  <article class="bill-model-card">
                    <header><h4>agent</h4><span>ä»£ç†</span></header>
                    <pre id="bill-breakdown-agent">å°šæœªè¼‰å…¥ã€‚</pre>
                  </article>
                  <article class="bill-model-card">
                    <header><h4>node</h4><span>ç¯€é»</span></header>
                    <pre id="bill-breakdown-node">å°šæœªè¼‰å…¥ã€‚</pre>
                  </article>
                </div>
              </section>

              <section class="bill-section">
                <div class="bill-section__header">
                  <h3>è¿‘æœŸ Session</h3>
                  <button type="button" class="bill-link-btn">æª¢è¦–å…¨éƒ¨</button>
                </div>
                <article class="bill-session-list">
                  <div class="bill-session-item">
                    <div><strong>ç›®å‰ Run</strong><small>å³æ™‚è²»ç”¨èˆ‡ token</small></div>
                    <p id="bill-current-run">--</p>
                  </div>
                  <div class="bill-session-item">
                    <div><strong>automation / interactive</strong><small>æ¨¡å¼åˆ†ä½ˆ</small></div>
                    <p id="bill-mode-summary">--</p>
                  </div>
                </article>
              </section>

              <button type="button" class="bill-export-btn">ä¸‹è¼‰ç™¼ç¥¨ CSV</button>

              <section class="bill-advanced" aria-label="é€²éš billing åŸå§‹è³‡æ–™">
                <article class="config-card">
                  <h3>Budgets</h3>
                  <pre id="bill-budgets">å°šæœªè¼‰å…¥ã€‚</pre>
                </article>
                <article class="config-card">
                  <h3>è¶…é™äº‹ä»¶ï¼ˆbudget_exceededï¼‰</h3>
                  <ul id="bill-exceeded" class="logs-list"></ul>
                </article>
              </section>
            </div>

            <footer class="bill-bottom-nav" aria-label="åº•éƒ¨å°è¦½">
              <a href="#/tools">ä»£ç†</a>
              <a href="#/chat">å°è©±</a>
              <a href="#/billing" class="is-active">Billing</a>
              <a href="#/config">è¨­å®š</a>
            </footer>
          </section>


          <section class="main-card config-page config-page--settings" id="config-page" hidden>
            <header class="settings-topbar">
              <button type="button" class="settings-link">â† å°è©±</button>
              <h2>ä»£ç†è¨­å®š</h2>
              <button type="button" class="settings-done" id="config-export">å®Œæˆ</button>
            </header>

            <div class="settings-scroll">
              <section class="settings-section">
                <h3>æ ¸å¿ƒæ™ºæ…§</h3>
                <article class="settings-card">
                  <button type="button" class="settings-row">
                    <div class="settings-row__icon settings-row__icon--primary">ğŸ¤–</div>
                    <div class="settings-row__content">
                      <p>æ¨¡å‹é¸æ“‡</p>
                      <small>Llama-3-8B-Instruct</small>
                    </div>
                    <div class="settings-row__meta"><span class="dot-ready"></span> Ready</div>
                  </button>
                  <button type="button" class="settings-row settings-row--border">
                    <div class="settings-row__icon settings-row__icon--purple">ğŸ—„ï¸</div>
                    <div class="settings-row__content">
                      <p>API Endpoint</p>
                      <small>Local (127.0.0.1:11434)</small>
                    </div>
                    <div class="settings-row__meta">â€º</div>
                  </button>
                </article>
                <p class="settings-hint">å·²é€£ç·šæœ¬æ©Ÿ Ollamaï¼ˆport 11434ï¼‰ã€‚</p>
              </section>

              <section class="settings-section">
                <h3>å€‹æ€§è¨­å®š</h3>
                <article class="settings-card">
                  <div class="settings-block">
                    <div class="settings-block__header">
                      <strong>ç³»çµ±æç¤ºè©</strong>
                      <button type="button" class="settings-pill">ç·¨è¼¯</button>
                    </div>
                    <pre class="settings-code">You are a helpful, precision-focused coding assistant. Answer concisely and prioritize modern best practices.</pre>
                  </div>
                  <div class="settings-block settings-block--border">
                    <div class="settings-block__header">
                      <strong>å‰µé€ åŠ›ï¼ˆTempï¼‰</strong>
                      <span class="settings-value">0.7</span>
                    </div>
                    <input type="range" min="0" max="100" value="70" class="settings-range" />
                    <div class="settings-scale"><span>ç²¾æº–</span><span>å‰µæ„</span></div>
                  </div>
                </article>
              </section>

              <section class="settings-section">
                <h3>å…§å®¹èˆ‡è¨˜æ†¶</h3>
                <article class="settings-card">
                  <div class="settings-row settings-row--static">
                    <div class="settings-row__content">
                      <p>Context Window</p>
                    </div>
                    <div class="settings-segment"><span>4k</span><span class="is-active">8k</span><span>16k</span><span>32k</span></div>
                  </div>
                  <div class="settings-row settings-row--border settings-row--static">
                    <div class="settings-row__content">
                      <p>å‘é‡è³‡æ–™åº«</p>
                      <small>/usr/local/var/chromadb/default</small>
                    </div>
                    <div class="settings-row__meta">ğŸ“</div>
                  </div>
                </article>
              </section>

              <section class="settings-section">
                <h3>ä»‹é¢è¨­å®š</h3>
                <article class="settings-card">
                  <label class="settings-toggle-row settings-row--border">
                    <div><p>ä¸²æµå›è¦†</p><small>é€å­—è¼¸å‡º</small></div>
                    <input type="checkbox" checked />
                  </label>
                  <div class="settings-block settings-block--border">
                    <div class="settings-block__header"><strong>å­—é«”å¤§å°</strong></div>
                    <input type="range" min="0" max="2" value="1" class="settings-range" />
                  </div>
                  <label class="settings-toggle-row">
                    <div><p>éœ‡å‹•å›é¥‹</p></div>
                    <input type="checkbox" />
                  </label>
                </article>
              </section>

              <section class="settings-section settings-section--advanced">
                <div class="config-toolbar">
                  <label class="field-label config-toolbar__search">
                    æœå°‹ key path
                    <input type="search" id="config-search" placeholder="ä¾‹å¦‚ï¼šamon.ui.theme" />
                  </label>
                  <button type="button" class="secondary-btn" id="config-refresh">é‡æ–°æ•´ç†è¨­å®šè³‡æ–™</button>
                </div>

                <div class="config-grid">
                  <article class="config-card">
                    <h3>Global config</h3>
                    <pre id="config-global">å°šæœªè¼‰å…¥ã€‚</pre>
                  </article>
                  <article class="config-card">
                    <h3>Project config</h3>
                    <pre id="config-project">å°šæœªè¼‰å…¥ã€‚</pre>
                  </article>
                </div>

                <article class="config-card">
                  <h3>Effective configï¼ˆå«ä¾†æºï¼‰</h3>
                  <div id="config-effective-summary" class="config-effective-summary">å°šæœªè¼‰å…¥ã€‚</div>
                  <div class="config-table-wrap">
                    <table class="config-table" id="config-table">
                      <thead>
                        <tr>
                          <th>Key path</th>
                          <th>Effective</th>
                          <th>Source</th>
                        </tr>
                      </thead>
                      <tbody id="config-table-body"></tbody>
                    </table>
                  </div>
                </article>
              </section>
            </div>

            <footer class="settings-bottom-nav" aria-label="åº•éƒ¨å°èˆª">
              <a href="#/chat">å°è©±</a>
              <a href="#/tools">ä»£ç†</a>
              <a class="is-active" href="#/config">è¨­å®š</a>
              <a href="#/logs">æ—¥èªŒ</a>
            </footer>
          </section>

          <section class="main-card logs-events-page logs-events-page--mobile" id="logs-events-page" hidden>
            <header class="logs-mobile-topbar">
              <div class="logs-mobile-title">
                <h2>ç³»çµ±æ´»å‹•</h2>
                <p>æœ¬æ©Ÿä»£ç†ï¼šOmni-Node-01</p>
              </div>
              <div class="logs-mobile-actions">
                <span class="logs-live-pill">â— LIVE</span>
                <button type="button" class="logs-icon-btn" id="logs-download" aria-label="åˆ†äº«åŒ¯å‡º">â¤´</button>
                <button type="button" class="logs-icon-btn" aria-label="æ¸…ç†æ—¥èªŒ">ğŸ—‘</button>
              </div>
            </header>

            <section class="logs-search-block">
              <label class="logs-search-input" for="logs-filter-component">
                <span>ğŸ”</span>
                <input type="text" id="logs-filter-component" placeholder="æœå°‹é—œéµå­—æˆ– ID..." />
              </label>
              <div class="logs-filter-pills">
                <button type="button" class="is-active" id="logs-refresh">å…¨éƒ¨</button>
                <button type="button">Info</button>
                <button type="button">Warn</button>
                <button type="button">Error</button>
                <button type="button">Debug</button>
              </div>
            </section>

            <div class="logs-mobile-stream">
              <div id="logs-summary" class="logs-summary logs-summary--mobile">å°šæœªè¼‰å…¥ã€‚</div>
              <div id="logs-list" class="logs-list logs-list--mobile"></div>
              <div class="pager" id="logs-pager">
                <button type="button" class="secondary-btn" id="logs-prev">ä¸Šä¸€é </button>
                <span id="logs-page-label">ç¬¬ 1 é </span>
                <button type="button" class="secondary-btn" id="logs-next">ä¸‹ä¸€é </button>
              </div>
            </div>

            <section class="logs-events-advanced" aria-label="é€²éšç¯©é¸" hidden>
              <div class="logs-toolbar">
                <label class="field-label">ä¾†æº
                  <select id="logs-source">
                    <option value="amon">amon</option>
                    <option value="project">project</option>
                    <option value="billing">billing</option>
                  </select>
                </label>
                <label class="field-label">èµ·å§‹æ™‚é–“<input type="datetime-local" id="logs-time-from" /></label>
                <label class="field-label">çµæŸæ™‚é–“<input type="datetime-local" id="logs-time-to" /></label>
                <label class="field-label">project<input type="text" id="logs-filter-project" placeholder="project_id" /></label>
                <label class="field-label">run<input type="text" id="logs-filter-run" placeholder="run_id" /></label>
                <label class="field-label">node<input type="text" id="logs-filter-node" placeholder="node_id" /></label>
                <label class="field-label">severity
                  <select id="logs-filter-severity">
                    <option value="">å…¨éƒ¨</option>
                    <option value="INFO">INFO</option>
                    <option value="WARNING">WARNING</option>
                    <option value="ERROR">ERROR</option>
                  </select>
                </label>
              </div>

              <section class="events-panel">
                <h3>Events</h3>
                <div class="logs-toolbar">
                  <label class="field-label">type<input type="text" id="events-filter-type" placeholder="event type" /></label>
                  <label class="field-label">èµ·å§‹æ™‚é–“<input type="datetime-local" id="events-time-from" /></label>
                  <label class="field-label">çµæŸæ™‚é–“<input type="datetime-local" id="events-time-to" /></label>
                  <label class="field-label">project<input type="text" id="events-filter-project" placeholder="project_id" /></label>
                  <label class="field-label">run<input type="text" id="events-filter-run" placeholder="run_id" /></label>
                  <label class="field-label">node<input type="text" id="events-filter-node" placeholder="node_id" /></label>
                  <button type="button" class="secondary-btn" id="events-refresh">æŸ¥è©¢</button>
                </div>
                <div id="events-summary" class="logs-summary">å°šæœªè¼‰å…¥ã€‚</div>
                <div id="events-list" class="logs-list"></div>
                <div class="pager" id="events-pager">
                  <button type="button" class="secondary-btn" id="events-prev">ä¸Šä¸€é </button>
                  <span id="events-page-label">ç¬¬ 1 é </span>
                  <button type="button" class="secondary-btn" id="events-next">ä¸‹ä¸€é </button>
                </div>
              </section>
            </section>

            <button type="button" class="logs-fab" aria-label="æ²å‹•åˆ°åº•éƒ¨">â†“</button>

            <footer class="logs-bottom-nav" aria-label="åº•éƒ¨å°èˆª">
              <a href="#/graph">Dashboard</a>
              <a href="#/chat">Chat</a>
              <a href="#/logs" class="is-active">Logs</a>
              <a href="#/config">Settings</a>
            </footer>
          </section>

          <section class="main-card context-page context-page--mobile" id="context-page" hidden>
            <header class="context-mobile-topbar">
              <h2>Context Manager</h2>
              <button type="button" class="context-clear-btn" id="context-clear-chat">ğŸ—‘ æ¸…ç†ç´€éŒ„</button>
            </header>

            <div class="context-mobile-scroll">
              <section class="context-gauge-section" id="context-draft-box">
                <div class="context-gauge-wrap" aria-label="Context ç”¨é‡">
                  <svg viewBox="0 0 100 100" class="context-gauge-svg" aria-hidden="true">
                    <circle cx="50" cy="50" r="42"></circle>
                    <circle class="context-gauge-progress" cx="50" cy="50" r="42"></circle>
                  </svg>
                  <div class="context-gauge-center">
                    <p>TOTAL USAGE</p>
                    <strong>75%</strong>
                    <span>6,144 / 8,192</span>
                    <small>Tokens</small>
                  </div>
                </div>
                <p class="context-usage-hint">â„¹ï¸ Context window is filling up rapidly.</p>
              </section>

              <section class="context-metrics-grid">
                <article class="context-metric-card">
                  <p>å‰©é¤˜</p>
                  <strong>2,048</strong>
                  <small>Tokens available</small>
                </article>
                <article class="context-metric-card">
                  <p>é ä¼°æˆæœ¬</p>
                  <strong>$0.04</strong>
                  <small>Per current session</small>
                </article>
              </section>

              <section class="context-breakdown">
                <h3>è©³ç´°æ‹†è§£</h3>
                <article class="context-breakdown-card context-breakdown-card--history">
                  <header><strong>History</strong><span>4,352 Â· 53%</span></header>
                  <small>Recent user &amp; AI turns</small>
                  <div class="context-breakdown-bar"><span style="width:53%"></span></div>
                  <button type="button" class="context-card-link" id="context-extract-chat">æŸ¥çœ‹è¨˜éŒ„ â€º</button>
                </article>
                <article class="context-breakdown-card">
                  <header><strong>Tools</strong><span>1,024 Â· 12.5%</span></header>
                  <small>JSON Schemas</small>
                  <div class="context-breakdown-bar"><span style="width:12.5%"></span></div>
                </article>
                <article class="context-breakdown-card">
                  <header><strong>System</strong><span>512 Â· 6.2%</span></header>
                  <small>Core Instructions</small>
                  <div class="context-breakdown-bar"><span style="width:6.2%"></span></div>
                </article>
                <article class="context-breakdown-card">
                  <header><strong>Plugins</strong><span>256 Â· 3.1%</span></header>
                  <small>Loaded Scripts</small>
                  <div class="context-breakdown-bar"><span style="width:3.1%"></span></div>
                </article>
              </section>

              <section class="context-editor-card">
                <label class="field-label" for="context-draft-input">Context è‰ç¨¿ï¼ˆå¯ç·¨è¼¯ï¼‰</label>
                <textarea id="context-draft-input" rows="8" placeholder="ä¾‹å¦‚ï¼šå°ˆæ¡ˆç›®æ¨™ã€èªæ°£åå¥½ã€é‡è¦é™åˆ¶æ¢ä»¶..."></textarea>
                <p id="context-draft-meta" class="context-draft__meta">å°šæœªå„²å­˜è‰ç¨¿ã€‚</p>
                <div class="context-draft__actions">
                  <button type="button" class="primary-btn" id="context-save-draft">å„²å­˜è‰ç¨¿ï¼ˆæœ¬æ©Ÿï¼‰</button>
                  <label class="secondary-btn file-btn-inline" for="context-import-file">å¾æª”æ¡ˆåŒ¯å…¥</label>
                  <input id="context-import-file" type="file" accept=".txt,.md,.json" hidden />
                  <button type="button" class="secondary-btn" id="context-clear-project">æ¸…ç©ºå°ˆæ¡ˆè‰ç¨¿</button>
                </div>
              </section>

              <button type="button" class="context-optimize-btn">âœ¨ æœ€ä½³åŒ– Context è¦–çª—</button>
            </div>

            <footer class="context-bottom-nav" aria-label="åº•éƒ¨å°èˆª">
              <a href="#/chat">Chat</a>
              <a href="#/tools">Agents</a>
              <a class="is-active" href="#/context">Context</a>
              <a href="#/config">Settings</a>
            </footer>
          </section>

          <section class="main-card graph-page graph-page--mobile" id="graph-page" hidden>
            <header class="graph-mobile-topbar">
              <button type="button" class="graph-mobile-back">â†</button>
              <div class="graph-mobile-title">
                <h2>EXECUTION FLOW</h2>
                <p>Agent: Research_Bot_v2</p>
              </div>
              <button type="button" class="graph-stop-btn">STOP AGENT</button>
            </header>

            <div class="graph-mobile-canvas">
              <div class="graph-mobile-search"><span>ğŸ”</span><input type="search" placeholder="Search nodes..." /></div>
              <div class="graph-mobile-node graph-mobile-node--intent">
                <header><strong>USER INTENT</strong></header>
                <p>"Analyze current market trends for sustainable energy in EU..."</p>
                <footer><span>IDï¼šUX-492</span><span>14:02:11</span></footer>
              </div>

              <div class="graph-mobile-arrow">â†“</div>

              <div class="graph-mobile-node graph-mobile-node--tool">
                <header><strong>TOOL CALL</strong></header>
                <pre>web_search({query: "EU sustainable energy 2024"})</pre>
                <footer><span>Status: Completed</span><span>342ms</span></footer>
              </div>

              <div class="graph-mobile-arrow">â†“</div>

              <div class="graph-mobile-node graph-mobile-node--thinking">
                <header><strong>THINKING</strong></header>
                <div class="graph-mobile-progress"><span></span></div>
                <p>Synthesizing search results and formulating response structure...</p>
                <footer><span>Processing...</span><span>Conf: 0.94</span></footer>
              </div>

              <div class="graph-floating-controls" aria-label="ç¸®æ”¾æ§åˆ¶">
                <button type="button">ï¼‹</button>
                <button type="button">ï¼</button>
                <button type="button" class="is-primary">â—</button>
              </div>
            </div>

            <div class="graph-mobile-hidden-data" hidden>
              <header class="graph-page__header">
                <div>
                  <h2>Graph</h2>
                  <p class="subtitle">æµç¨‹åœ–ä¸»è¦–åœ–ï¼ˆæ”¯æ´åˆ‡æ›æ­·å² Runï¼‰ã€‚</p>
                </div>
                <div class="graph-page__controls">
                  <label class="field-label">
                    æ­·å² Run
                    <select id="graph-run-select"></select>
                  </label>
                  <button type="button" class="secondary-btn" id="graph-history-refresh">é‡æ–°æ•´ç†</button>
                  <button type="button" class="secondary-btn" id="copy-run-id" disabled data-i18n="button.copyRunId" data-i18n-attr="aria-label:button.copyRunIdAria">è¤‡è£½ Run ID</button>
                </div>
              </header>
              <div class="graph-toolbar">
                <div class="graph-run-meta-wrap">
                  <span id="graph-run-meta" class="graph-run-meta">å°šæœªåµæ¸¬åˆ° Run</span>
                </div>
                <div class="graph-toolbar__actions">
                  <button type="button" class="secondary-btn" id="graph-create-template">Create template</button>
                </div>
              </div>
              <div id="graph-preview" class="graph-preview"></div>
              <ul id="graph-node-list" class="graph-node-list"></ul>
              <pre id="graph-code" class="graph-code"></pre>
            </div>

            <footer class="graph-bottom-nav" aria-label="åº•éƒ¨å°èˆª">
              <a href="#/chat">CHAT</a>
              <a href="#/graph" class="is-active">EXECUTION</a>
              <a href="#/context">MEMORY</a>
              <a href="#/config">AGENT SETTINGS</a>
            </footer>
          </section>

          <section class="main-card docs-page" id="docs-page" hidden>
            <header class="docs-page__header">
              <div>
                <h2>Docs</h2>
                <p class="subtitle">ä¾ run/task æª¢è¦–æ–‡ä»¶ï¼Œé è¦½ markdownï¼Œä¸¦æ’å…¥ Chat å¼•ç”¨ã€‚</p>
              </div>
              <button type="button" class="secondary-btn" id="docs-refresh">é‡æ–°æ•´ç†</button>
            </header>
            <div class="docs-layout">
              <aside class="docs-tree" id="docs-tree-wrap">
                <div class="docs-tree__meta" id="docs-tree-meta">å°šæœªè¼‰å…¥ã€‚</div>
                <input type="search" id="docs-filter" class="docs-filter" placeholder="æœå°‹æª”åæˆ–è·¯å¾‘ï¼ˆclient-sideï¼‰" data-i18n-attr="placeholder:placeholder.docsFilter" />
                <div class="docs-tree__viewport" id="docs-tree-viewport" role="list"></div>
              </aside>
              <article class="docs-preview">
                <header class="docs-preview__header">
                  <div>
                    <h3 id="docs-preview-title">è«‹å¾å·¦å´é¸æ“‡æ–‡ä»¶</h3>
                    <p id="docs-preview-meta" class="docs-preview__meta">ä¾†æº run / node å°‡é¡¯ç¤ºæ–¼æ­¤ã€‚</p>
                  </div>
                  <div class="docs-preview__actions">
                    <button type="button" class="secondary-btn" id="docs-open" disabled>Open</button>
                    <button type="button" class="secondary-btn" id="docs-download" disabled>Download</button>
                    <button type="button" class="primary-btn" id="docs-insert" disabled>æ’å…¥ @doc</button>
                  </div>
                </header>
                <div id="docs-preview-content" class="docs-preview__content">
                  <p class="empty-context">å°šæœªé¸æ“‡æ–‡ä»¶ã€‚</p>
                </div>
              </article>
            </div>
          </section>

          <section class="main-card tools-skills-page" id="tools-skills-page" hidden>
            <header class="tools-skills-page__header">
              <div>
                <h2>Tools &amp; Skills</h2>
                <p class="subtitle">ç®¡ç†å·¥å…·èˆ‡æŠ€èƒ½æ¸…å–®ï¼›æ‰€æœ‰æ¬Šé™è®Šæ›´éƒ½å¿…é ˆç¶“é Plan Card ç¢ºèªã€‚</p>
              </div>
              <button type="button" class="secondary-btn" id="tools-skills-refresh">é‡æ–°æ•´ç†</button>
            </header>

            <section class="tools-section">
              <h3>Tools</h3>
              <div id="tools-list" class="tools-list"></div>
            </section>

            <section class="skills-section">
              <h3>Skills</h3>
              <div id="skills-collisions" class="skills-collisions"></div>
              <div id="skills-list" class="skills-list"></div>
            </section>

            <section class="skills-preview-section">
              <h3>æ³¨å…¥é è¦½ï¼ˆä¸è§¸ç™¼æ¨¡å‹ï¼‰</h3>
              <div class="skills-preview-controls">
                <select id="skill-trigger-select"></select>
                <button type="button" class="primary-btn" id="skill-trigger-preview">é è¦½æ³¨å…¥å…§å®¹</button>
              </div>
              <pre id="skill-injection-preview" class="skill-injection-preview">å°šæœªç”¢ç”Ÿé è¦½ã€‚</pre>
            </section>
          </section>
        </section>
      </div>
    </main>

    <div id="toast" class="toast toast--info" role="status" aria-live="polite"></div>
    <div id="confirm-modal" class="confirm-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="confirm-modal-title" aria-describedby="confirm-modal-description" hidden>
      <div class="confirm-modal__panel">
        <h3 class="confirm-modal__title" id="confirm-modal-title" data-confirm-title data-i18n="modal.confirm.title">è«‹å†æ¬¡ç¢ºèª</h3>
        <p class="confirm-modal__description" id="confirm-modal-description" data-confirm-description data-i18n="modal.confirm.description">é€™å€‹å‹•ä½œç„¡æ³•å¾©åŸï¼Œæ˜¯å¦ç¹¼çºŒï¼Ÿ</p>
        <div class="confirm-modal__actions">
          <button type="button" class="secondary-btn" data-confirm-cancel data-i18n="modal.confirm.cancel">å–æ¶ˆ</button>
          <button type="button" class="primary-btn" data-confirm-ok data-i18n="modal.confirm.ok">ç¢ºèª</button>
        </div>
      </div>
    </div>

    <div id="artifact-preview-modal" class="artifact-preview-modal" role="dialog" aria-modal="true" aria-hidden="true" hidden>
      <div class="artifact-preview-modal__panel">
        <header class="artifact-preview-modal__header">
          <h3 id="artifact-preview-title">Artifact é è¦½</h3>
          <button type="button" class="secondary-btn small" id="artifact-preview-close">é—œé–‰</button>
        </header>
        <div class="artifact-preview-modal__actions">
          <button type="button" class="secondary-btn small" id="artifact-preview-download">ä¸‹è¼‰æª”æ¡ˆ</button>
          <button type="button" class="secondary-btn small" id="artifact-preview-copy" hidden>è¤‡è£½å…§å®¹</button>
        </div>
        <div id="artifact-preview-body" class="artifact-preview-modal__body"></div>
      </div>
    </div>
    <aside id="graph-node-drawer" class="graph-node-drawer" hidden>
      <header class="graph-node-drawer__header">
        <h3 id="graph-node-title">Node è©³ç´°</h3>
        <button type="button" class="secondary-btn" id="graph-node-close" data-i18n-attr="aria-label:button.collapseGraphNode">é—œé–‰</button>
      </header>
      <div class="graph-node-drawer__meta" id="graph-node-meta"></div>
      <section>
        <h4>inputs</h4>
        <details open>
          <summary>å±•é–‹å…§å®¹</summary>
          <pre id="graph-node-inputs" class="graph-node-json"></pre>
        </details>
      </section>
      <section>
        <h4>outputsï¼ˆdocs/artifactsï¼‰</h4>
        <pre id="graph-node-outputs" class="graph-node-json"></pre>
      </section>
      <section>
        <h4>æœ€è¿‘ events/logs</h4>
        <ul id="graph-node-events" class="graph-node-events"></ul>
      </section>
      <section>
        <h4>Template åŒ–</h4>
        <div class="graph-node-drawer__actions">
          <button type="button" class="secondary-btn" id="graph-parametrize">Parametrizeï¼ˆæ”¹æˆ {{var}}ï¼‰</button>
        </div>
      </section>
    </aside>

    <script src="/event_stream_client.js"></script>
    <script type="module" src="/static/js/app.js"></script>
  </body>
</html>
